<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;overflow:hidden;font-family:Arial;}

#video{
 position:absolute;width:100%;height:100%;
 object-fit:cover;z-index:1;
}

#canvas{
 position:absolute;top:0;left:0;z-index:2;
}

.ui{
 position:absolute;
 background:rgba(0,0,0,0.65);
 color:white;
 padding:10px 15px;
 border-radius:12px;
 z-index:3;
}

#msg{top:10px;left:50%;transform:translateX(-50%);}
#score{bottom:10px;left:10px;}
#timer{bottom:10px;right:10px;}
</style>
</head>

<body>

<div id="msg" class="ui">üëã Conecta la energ√≠a (punto 1)</div>
<div id="score" class="ui">‚≠ê Puntaje: 0</div>
<div id="timer" class="ui">‚è±Ô∏è Tiempo: 60</div>

<video id="video" autoplay playsinline></video>
<canvas id="canvas"></canvas>

<script>
const video=document.getElementById("video");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

const msg=document.getElementById("msg");
const scoreTxt=document.getElementById("score");
const timerTxt=document.getElementById("timer");

// C√°mara trasera
navigator.mediaDevices.getUserMedia({
 video:{facingMode:"environment"}
}).then(s=>video.srcObject=s);

// Tama√±o
function resize(){
 canvas.width=innerWidth;
 canvas.height=innerHeight;
}
resize();
onresize=resize;

// --------- JUEGO ---------

let step=0;
let score=0;
let time=60;
let gameOver=false;

// temporizador
setInterval(()=>{
 if(gameOver) return;
 time--;
 timerTxt.innerText="‚è±Ô∏è Tiempo: "+time;
 if(time<=0){
   msg.innerText="‚è∞ Tiempo agotado";
   gameOver=true;
 }
},1000);

// puntos conexi√≥n
const points=[
 {x:90,y:300},
 {x:180,y:300},
 {x:270,y:300}
];

canvas.addEventListener("click",(e)=>{
 if(gameOver) return;

 const x=e.clientX;
 const y=e.clientY;

 points.forEach((p,i)=>{
  if(Math.hypot(p.x-x,p.y-y)<25){
    connect(i);
  }
 });
});

function connect(i){

 if(step===0 && i===0){
   msg.innerText="‚úÖ Energ√≠a lista! Conecta resistencia";
   score+=10;
   step=1;
 }
 else if(step===1 && i===1){
   msg.innerText="üëç Resistencia correcta! Ahora LED";
   score+=10;
   step=2;
 }
 else if(step===2 && i===2){
   msg.innerText="üéâ Circuito completo!";
   score+=20;
   step=3;
   gameOver=true;
 }
 else{
   msg.innerText="‚ùå Error de conexi√≥n";
   score-=5;
 }

 scoreTxt.innerText="‚≠ê Puntaje: "+score;
}

// --------- DIBUJO REALISTA ---------

function protoboard(){
 ctx.fillStyle="#d9d9d9";
 ctx.fillRect(40,240,320,140);

 // agujeros
 for(let i=0;i<10;i++){
  for(let j=0;j<4;j++){
   ctx.fillStyle="#888";
   ctx.beginPath();
   ctx.arc(60+i*30,260+j*30,4,0,Math.PI*2);
   ctx.fill();
  }
 }
}

function led(){
 // base
 ctx.fillStyle="#222";
 ctx.fillRect(255,310,10,25);

 // luz
 ctx.fillStyle=(step===3)?"lime":"darkred";
 ctx.beginPath();
 ctx.arc(260,300,14,0,Math.PI*2);
 ctx.fill();
}

function resistor(){
 ctx.fillStyle="#c69c6d";
 ctx.fillRect(165,290,40,18);

 ctx.strokeStyle="black";
 for(let i=0;i<4;i++){
   ctx.beginPath();
   ctx.moveTo(170+i*10,290);
   ctx.lineTo(170+i*10,308);
   ctx.stroke();
 }
}

function wires(){
 ctx.strokeStyle="lime";
 ctx.lineWidth=2;

 if(step>0){
  ctx.beginPath();
  ctx.moveTo(90,300);
  ctx.lineTo(180,300);
  ctx.stroke();
 }

 if(step>1){
  ctx.beginPath();
  ctx.moveTo(180,300);
  ctx.lineTo(270,300);
  ctx.stroke();
 }
}

function pointsDraw(){
 points.forEach((p,i)=>{
   ctx.fillStyle="cyan";
   ctx.beginPath();
   ctx.arc(p.x,p.y,10,0,Math.PI*2);
   ctx.fill();

   ctx.fillStyle="black";
   ctx.fillText(i+1,p.x-4,p.y+4);
 });
}

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);

 protoboard();
 resistor();
 led();
 wires();
 pointsDraw();

 requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>



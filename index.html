<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AR Tutor Circuitos</title>

<style>
body{margin:0;overflow:hidden;font-family:Arial;}
#msg{
 position:absolute;
 top:10px;left:10px;
 background:rgba(0,0,0,0.6);
 color:white;
 padding:12px;
 border-radius:10px;
 font-size:18px;
 max-width:90%;
}
</style>
</head>

<body>

<div id="msg">ðŸ‘‹ Bienvenido! Toca el punto de energÃ­a primero.</div>

<video id="video" autoplay playsinline
style="position:absolute;width:100%;height:100%;object-fit:cover;"></video>

<canvas id="canvas"
style="position:absolute;top:0;left:0;"></canvas>

<script>
const video=document.getElementById("video");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const msg=document.getElementById("msg");

// CÃ¡mara trasera
navigator.mediaDevices.getUserMedia({
 video:{facingMode:"environment"}
}).then(s=>video.srcObject=s);

// TamaÃ±o
function resize(){
 canvas.width=innerWidth;
 canvas.height=innerHeight;
}
resize();
onresize=resize;

// ----- LÃ“GICA TUTOR IA -----

let step=0;
let connections=[];

// puntos de conexiÃ³n
const points=[
 {x:90,y:300,name:"energia"},
 {x:160,y:300,name:"resistencia"},
 {x:240,y:300,name:"led"}
];

canvas.addEventListener("click",(e)=>{
 const x=e.clientX;
 const y=e.clientY;

 points.forEach((p,i)=>{
   let d=Math.hypot(p.x-x,p.y-y);
   if(d<25){
     handleConnection(i);
   }
 });
});

function handleConnection(i){

 // guÃ­a paso a paso
 if(step===0 && i===0){
   msg.innerText="âœ… Bien! Ahora conecta la resistencia.";
   connections.push(i);
   step=1;
 }
 else if(step===1 && i===1){
   msg.innerText="ðŸ‘ Correcto! Ahora conecta el LED.";
   connections.push(i);
   step=2;
 }
 else if(step===2 && i===2){
   msg.innerText="ðŸŽ‰ Circuito completo! LED encendido.";
   connections.push(i);
   step=3;
 }
 else{
   msg.innerText="âŒ Orden incorrecto. Sigue las instrucciones.";
 }
}

// ----- DIBUJO AR -----

function drawProtoboard(){
 ctx.strokeStyle="white";
 ctx.lineWidth=4;
 ctx.strokeRect(40,240,300,150);

 // agujeros
 for(let i=0;i<10;i++){
  for(let j=0;j<3;j++){
   ctx.fillStyle="gray";
   ctx.beginPath();
   ctx.arc(60+i*28,260+j*35,3,0,Math.PI*2);
   ctx.fill();
  }
 }
}

function drawPoints(){
 points.forEach((p,i)=>{
   ctx.fillStyle="cyan";
   ctx.beginPath();
   ctx.arc(p.x,p.y,20,0,Math.PI*2);
   ctx.fill();

   ctx.fillStyle="black";
   ctx.fillText(i+1,p.x-5,p.y+5);
 });
}

function drawComponents(){

 // resistencia
 ctx.fillStyle="yellow";
 ctx.fillRect(140,290,40,20);

 // LED
 ctx.fillStyle=(step===3)?"lime":"red";
 ctx.beginPath();
 ctx.arc(260,300,15,0,Math.PI*2);
 ctx.fill();
}

function drawWires(){
 ctx.strokeStyle="lime";
 ctx.lineWidth=4;

 if(connections.includes(0)){
   ctx.beginPath();
   ctx.moveTo(90,300);
   ctx.lineTo(160,300);
   ctx.stroke();
 }
 if(connections.includes(1)){
   ctx.beginPath();
   ctx.moveTo(160,300);
   ctx.lineTo(240,300);
   ctx.stroke();
 }
}

// loop
function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);

 drawProtoboard();
 drawPoints();
 drawComponents();
 drawWires();

 requestAnimationFrame(draw);
}
draw();

</script>

</body>
</html>
